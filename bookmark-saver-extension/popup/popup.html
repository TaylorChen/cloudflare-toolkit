<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>书签收藏助手</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <div class="container">
    <!-- 头部 -->
    <header class="header">
      <h1 class="title">
        <svg class="icon-bookmark" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
        书签收藏助手
      </h1>
      <button class="btn-settings" id="btnSettings" title="设置">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="3" />
          <path d="M12 1v6m0 6v6M5.6 5.6l4.2 4.2m4.2 4.2l4.2 4.2M1 12h6m6 0h6M5.6 18.4l4.2-4.2m4.2-4.2l4.2-4.2"
            stroke-width="2" stroke-linecap="round" />
        </svg>
      </button>
    </header>

    <!-- 左右分栏主内容区 -->
    <div class="main-content">
      <!-- 左侧栏 - 快速收藏 -->
      <aside class="left-panel">
        <section class="quick-save-compact">
          <h2 class="section-title">🚀 快速收藏</h2>
          <form id="saveForm" class="save-form-compact">
            <div class="form-group">
              <label for="inputTitle">标题</label>
              <input type="text" id="inputTitle" class="form-input" placeholder="自动填充" required maxlength="200">
            </div>

            <div class="form-group">
              <label for="inputDescription">备注 (可选)</label>
              <textarea id="inputDescription" class="form-textarea" placeholder="添加备注..." maxlength="500"
                rows="2"></textarea>
            </div>

            <div class="form-group">
              <label for="inputTags">标签 (可选)</label>
              <input type="text" id="inputTags" class="form-input" placeholder="默认:默认分类">
              <small class="hint">多个标签用逗号分隔</small>
            </div>

            <input type="hidden" id="inputUrl">

            <button type="submit" class="btn-primary-full" id="btnSave">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" stroke-width="2" />
                <polyline points="17 21 17 13 7 13 7 21" stroke-width="2" />
                <polyline points="7 3 7 8 15 8" stroke-width="2" />
              </svg>
              一键收藏
            </button>
          </form>
        </section>
      </aside>

      <!-- 右侧栏 - 书签列表 -->
      <main class="right-panel">
        <!-- 搜索栏 -->
        <div class="search-section">
          <div class="search-box">
            <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="11" cy="11" r="8" stroke-width="2" />
              <path d="m21 21-4.35-4.35" stroke-width="2" stroke-linecap="round" />
            </svg>
            <input type="text" id="searchInput" class="search-input" placeholder="搜索书签...">
            <button class="btn-clear" id="btnClearSearch" style="display: none;">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <line x1="18" y1="6" x2="6" y2="18" stroke-width="2" />
                <line x1="6" y1="6" x2="18" y2="18" stroke-width="2" />
              </svg>
            </button>
          </div>
        </div>

        <!-- 标签分组书签列表 -->
        <div class="bookmarks-section">
          <div class="section-header">
            <h2 class="section-title">📚 我的书签 (<span id="bookmarkCount">0</span>)</h2>
            <button class="btn-text" id="btnRefresh" title="刷新">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polyline points="23 4 23 10 17 10" stroke-width="2" />
                <polyline points="1 20 1 14 7 14" stroke-width="2" />
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" stroke-width="2" />
              </svg>
            </button>
          </div>

          <div id="bookmarksGrouped" class="bookmarks-grouped">
            <!-- 标签分组将通过 JS 动态插入 -->
            <div class="empty-state" id="emptyState">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" opacity="0.3">
                <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" stroke-width="2" />
              </svg>
              <p>暂无书签</p>
              <p class="text-hint">点击左侧"一键收藏"按钮开始收藏</p>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- 设置面板 -->
    <div class="settings-panel" id="settingsPanel" style="display: none;">
      <div class="settings-header">
        <h2 class="section-title">设置</h2>
        <button class="btn-close" id="btnCloseSettings">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <line x1="18" y1="6" x2="6" y2="18" stroke-width="2" />
            <line x1="6" y1="6" x2="18" y2="18" stroke-width="2" />
          </svg>
        </button>
      </div>

      <div class="settings-content">
        <div class="setting-group">
          <label class="setting-label">API 服务地址</label>
          <div class="input-with-action">
            <input type="text" id="apiBaseUrl" class="form-input" placeholder="https://your-worker.workers.dev">
            <button class="btn-secondary" id="btnSaveApiUrl">保存</button>
          </div>
          <p class="text-hint">生产环境请配置 Cloudflare Workers 地址</p>
          <p class="text-hint">默认: http://localhost:8787</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">API Key (安全密钥)</label>
          <div class="input-with-action">
            <input type="password" id="apiKey" class="form-input" placeholder="输入 API Key">
            <button class="btn-secondary" id="btnSaveApiKey">保存</button>
          </div>
          <p class="text-hint">配置后端 wrangler.jsonc 中的 API_KEY</p>
          <p class="text-hint">开发环境默认: dev-test-key-12345</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">当前 User ID</label>
          <div class="input-with-action">
            <input type="text" id="currentUserId" class="form-input" readonly>
            <button class="btn-secondary" id="btnCopyUserId">复制</button>
          </div>
          <p class="text-hint">用于跨设备同步,请妥善保管</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">导入 User ID</label>
          <div class="input-with-action">
            <input type="text" id="importUserId" class="form-input" placeholder="粘贴 User ID">
            <button class="btn-secondary" id="btnImportUserId">导入</button>
          </div>
          <p class="text-hint">导入后将同步对应账户的书签数据</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">窗口尺寸</label>
          <div class="size-options">
            <button class="btn-size" data-size="compact">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <rect x="3" y="3" width="18" height="18" rx="2" stroke-width="2" />
              </svg>
              紧凑
            </button>
            <button class="btn-size active" data-size="standard">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <rect x="3" y="3" width="18" height="18" rx="2" stroke-width="2" />
              </svg>
              标准
            </button>
            <button class="btn-size" data-size="spacious">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <rect x="3" y="3" width="18" height="18" rx="2" stroke-width="2" />
              </svg>
              宽敞
            </button>
          </div>
          <p class="text-hint">选择适合您的显示尺寸</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">数据管理</label>
          <button class="btn-danger" id="btnExportData">导出所有书签 (JSON)</button>
        </div>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>

</html>